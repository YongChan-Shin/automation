<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="css/style.css">
  <!-- jQuery CDN -->
  <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="js/excel.min.js"></script>
  <title>Document</title>
</head>
<body>
  <div class='input_container'>
    <input type='file' id='file'/>
    <div class="button">
      <button type="button" class="btn_download">이미지 저장하기</button>
    </div>
    <div id='grid'></div>
  </div>

  <!-- 1단(좌측) -->
  <div class="container" id="container1">
    <!-- <div class="inner" id="inner1"> -->
      <!-- <div class="logo">
        <img src="images/common/logo.jpg" alt="">
      </div>
      <div id="set_wrap">
        <p class="set" id="set_1">돌체세트</p>
        <span class="color">Color : </span><p class="color" id="color_1">아이보리</p>
        <p class="size">5호, 7호, 9호, 11호</p>
        <div class="text_wrap">
          <p class="text" id="text1_1">- 후드를 입은 테디베어 나염으로 포인트</p>
          <p class="text" id="text1_2">- 아이보리 상의에 핑크 컬러 하의 조합</p>
          <p class="text" id="text1_3">- 팬츠 옆에 라인까지 디테일이 좋은 아이템</p>
        </div>

        <div class="main_img" id="main_img1_1">
          <img src="images/돌체세트1.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_2">
          <img src="images/돌체세트2.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_3">
          <img src="images/돌체세트3.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_4">
          <img src="images/돌체세트4.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="feature">
          <img src="images/common/feature.jpg" alt="">
        </div>
        <div class="mb_l"></div>

        <div class="product_wrap">
          <p class="view">PRODUCT VIEW</p>
          <p class="view_detail">제품의 색상은 디테일 컷과 가장 유사하며, 모니터 해상도에 따라 차이가 있을 수 있습니다.</p>
        </div>

        <div class="main_img stitch" id="main_img1_5">
          <img src="images/돌체세트5.jpg" alt="">
          <div class="stitch_circle"></div>
          <div class="stitch_text">커버 스티치 공법으로 목 늘어남을 방지해요!</div>
          <div class="stitch_explain">※ 커버 스티치(cover stitch) : 목과 소매 등 늘어나기 쉬운 부분에 인장력이 좋은 실을 사용하여 늘어남을 방지하는 공법</div>
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_6">
          <img src="images/돌체세트6.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_7">
          <img src="images/돌체세트7.jpg" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img1_8">
          <img src="images/돌체세트8.jpg" alt="">
        </div>
        <div class="mb_xl"></div>

      <div class="size_top" id="size_top1">
        <img src="images/common/size/size_w_top_un.jpg" alt="">
      </div>
      <div class="size_bottom" id="size_bottom1">
        <img src="images/common/size/size_w_bottom_band.jpg" alt="">
      </div>
      <div class="mb_xl"></div>
      <div class="model">
        <img src="images/common/model.jpg" alt="">
      </div>
      <div class="information">
        <img src="images/common/information.jpg" alt="">
      </div> -->
    </div>
  </div>

  <!-- 2단(우측) -->
  <div class="container" id="container2">

  </div>

<script src="js/html2canvas.min.js"></script>

<script>
  for(let i=1;i<=29;i++) {
    var inner = 'inner' + i
    var div = document.createElement('div')
    div.setAttribute('class', 'inner')
    div.setAttribute('id', inner)
    div.innerHTML = `
      <div class="logo">
        <img src="images/common/logo.jpg" alt="">
      </div>
      <div id="set_wrap">
        <p class="set" id="set_${i}"></p>
        <span class="color">Color : </span><p class="color" id="color_${i}"></p>
        <p class="size">5호, 7호, 9호, 11호</p>
        <div class="text_wrap">
          <p class="text" id="text${i}_1"></p>
          <p class="text" id="text${i}_2"></p>
          <p class="text" id="text${i}_3"></p>
        </div>

        <div class="main_img" id="main_img${i}_1">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_2">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_3">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_4">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="feature">
          <img src="images/common/feature.jpg" alt="">
        </div>
        <div class="mb_l"></div>

        <div class="product_wrap">
          <p class="view">PRODUCT VIEW</p>
          <p class="view_detail">제품의 색상은 디테일 컷과 가장 유사하며, 모니터 해상도에 따라 차이가 있을 수 있습니다.</p>
        </div>

        <div class="main_img stitch" id="main_img${i}_5">
          <img src="" alt="">
          <div class="stitch_circle"></div>
          <div class="stitch_text">커버 스티치 공법으로 목 늘어남을 방지해요!</div>
          <div class="stitch_explain">※ 커버 스티치(cover stitch) : 목과 소매 등 늘어나기 쉬운 부분에 인장력이 좋은 실을 사용하여 늘어남을 방지하는 공법</div>
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_6">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_7">
          <img src="" alt="">
        </div>
        <div class="mb_s"></div>
        <div class="main_img" id="main_img${i}_8">
          <img src="" alt="">
        </div>
        <div class="mb_xl"></div>

      <div class="size_top" id="size_top${i}">
        <img src="images/common/size/size_w_top_un.jpg" alt="">
      </div>
      <div class="size_bottom" id="size_bottom${i}">
        <img src="images/common/size/size_w_bottom_band.jpg" alt="">
      </div>
      <div class="mb_xl"></div>
      <div class="model">
        <img src="images/common/model.jpg" alt="">
      </div>
      <div class="information">
        <img src="images/common/information.jpg" alt="">
      </div>
      `
    
    document.getElementById('container1').appendChild(div)

    /* if(i % 2 == 0) {
      document.getElementById('container2').appendChild(div)
    }
    else {
      document.getElementById('container1').appendChild(div)
    } */

  }

  window.devicePixelRatio = 1
  // window.devicePixelRatio = 2 // 고해상도
  <!-- 이미지 다운로드 스크립트 -->
  $(function(){
    $(".btn_download").click(function(e){
      for (let i=1;i<=1;i++) {
        html2canvas(document.getElementById("inner"+i)).then(function(canvas) {
            var el = document.createElement("a")
            el.href = canvas.toDataURL("images/jpeg")
            let product_name = document.querySelector('#set_' + i).innerText
            // el.download = i + '번_' + product_name + ".jpg" // 다운로드 할 파일명 설정
            if(i < 10) {
              el.download = "0" + i + "_" + product_name + ".jpg"   
            }
            else {
              el.download = i + "_" + product_name + ".jpg"   
            }
            el.click()
        })
      }
    })
  })

  <!-- 엑셀 불러오기 스크립트 -->
  var test1 = null, test2 = null;
  function gridExcelToWeb(file, target){
    var reader = new FileReader();

    reader.onload = function (evt) {
        if (evt.target.readyState == FileReader.DONE) {
            var data = evt.target.result;  //해당 데이터, 웹 서버에서 ajax같은거로 가져온 blob 형태의 데이터를 넣어주어도 동작 한다.
            data = new Uint8Array(data);
            var workbook = XLSX.read(data, { type: 'array' });
            var sheetName = '';
            workbook.SheetNames.forEach( function(data, idx){   //시트 여러개라면 이 안에서 반복문을 통해 돌리면 된다.
                if(idx == 0){
                    sheetName = data;
                }
            });
            test1 = workbook;

            var toHtml = XLSX.utils.sheet_to_html(workbook.Sheets[sheetName], { header: '' });

            target.html(toHtml);
            target.find('table').attr({class:'table table-bordered',id:'excelResult'});  //id나 class같은거를 줄 수 있다.
            test2 = toHtml;
            $('#excelResult').find('tr').each(function(idx){
                if(idx <=0 ){ 
                    $(this).css({'background-color':'#969da5a3'});
                }
            });
        }

        for(let num=1;num<=29;num++) {

          
          $('#set_' + num).text($('#sjs-B' + (num + 1)).text());
          $('#color_' + num).text($('#sjs-C' + (num + 1)).text());
          
          $('#text' + num + '_1').text($('#sjs-F' + (num + 1)).text());
          $('#text' + num + '_2').text($('#sjs-G' + (num + 1)).text());
          $('#text' + num + '_3').text($('#sjs-H' + (num + 1)).text());
          
          
          $('#inner' + num + ' #main_img' + num + '_1' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '1.jpg')
          $('#inner' + num + ' #main_img' + num + '_2' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '2.jpg')
          $('#inner' + num + ' #main_img' + num + '_3' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '3.jpg')
          $('#inner' + num + ' #main_img' + num + '_4' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '4.jpg')
          $('#inner' + num + ' #main_img' + num + '_5' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '5.jpg')
          $('#inner' + num + ' #main_img' + num + '_6' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '6.jpg')
          $('#inner' + num + ' #main_img' + num + '_7' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '7.jpg')
          $('#inner' + num + ' #main_img' + num + '_8' + ' img').attr('src', 'images/' + $('#sjs-B' + (num + 1)).text() + '8.jpg')

          $('#inner' + num + ' #size_top' + num + ' img').attr('src', 'images/common/size/' + $('#sjs-D' + (num + 1)).text() + '.jpg')
          $('#inner' + num + ' #size_bottom' + num + ' img').attr('src', 'images/common/size/' + $('#sjs-E' + (num + 1)).text() + '.jpg')


        }
    };
    reader.readAsArrayBuffer(file);
  }    

  $('#file').change( function(){
      const selectedFile = $(this)[0].files[0];
      gridExcelToWeb(selectedFile,  $('#grid'))

  });
</script>

</body>
</html>